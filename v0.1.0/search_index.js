var documenterSearchIndex = {"docs":
[{"location":"probints_comparison/#Comparison-to-ProbInts","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"","category":"section"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"The DifferentialEquations.jl documentation contains a section about Uncertainty Quantification. It describes the ProbInts method for quantification of numerical uncertainty, and provides an extension of ProbInts to adaptive step sizes.","category":"page"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"In this example, we want to compare the uncertainty estimates of Tsit5+AdaptiveProbInts to the posterior computed with the EKF1.","category":"page"},{"location":"probints_comparison/#.-Problem-definition:-FitzHugh-Nagumo","page":"Comparison to ProbInts","title":"1. Problem definition: FitzHugh-Nagumo","text":"","category":"section"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"using ODEFilters\nusing ODEFilters: remake_prob_with_jac, stack\nusing DifferentialEquations\nusing DiffEqUncertainty\nusing Statistics\nusing Plots\n\n\nfunction fitz!(du,u,p,t)\n    V,R = u\n    a,b,c = p\n    du[1] = c*(V - V^3/3 + R)\n    du[2] = -(1/c)*(V -  a - b*R)\nend\nu0 = [-1.0;1.0]\ntspan = (0.0,20.0)\np = (0.2,0.2,3.0)\nprob = ODEProblem(fitz!,u0,tspan,p)\nprob = remake_prob_with_jac(prob)\nnothing # hide","category":"page"},{"location":"probints_comparison/#High-accuracy-reference-solution:","page":"Comparison to ProbInts","title":"High accuracy reference solution:","text":"","category":"section"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"appxsol = solve(remake(prob, u0=big.(prob.u0)), abstol=1e-20, reltol=1e-20)\nplot(appxsol)\nsavefig(\"./figures/ex_pi_fitzhugh.svg\"); nothing # hide","category":"page"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"(Image: Prob-Ints Errors)","category":"page"},{"location":"probints_comparison/#.-ProbInts","page":"Comparison to ProbInts","title":"2. ProbInts","text":"","category":"section"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"Uncertainty quantification of Tsit5 with AdaptiveProbInts:","category":"page"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"cb = AdaptiveProbIntsUncertainty(5)\nensemble_prob = EnsembleProblem(prob)\nsol = solve(prob, Tsit5())\nsim = solve(ensemble_prob, Tsit5(), trajectories=100, callback=cb)\n\np = plot(sol.t, stack(appxsol.(sol.t) - sol.u), color=[3 4], ylims=(-0.003, 0.003), ylabel=\"Error\")\nerrors = [(a.t, stack(appxsol.(a.t) .- a.u)) for a in sim.u]\nfor e in errors\n    plot!(p, e[1], e[2], color=[3 4], label=\"\", linewidth=0.2, linealpha=0.5)\nend\nsavefig(\"./figures/ex_pi_probints.svg\"); nothing # hide","category":"page"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"(Image: Prob-Ints Errors)","category":"page"},{"location":"probints_comparison/#.-EKF1","page":"Comparison to ProbInts","title":"3. EKF1","text":"","category":"section"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"Uncertainties provided by the EKF1:","category":"page"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"sol = solve(prob, EKF1())\nplot(sol.t, stack(appxsol.(sol.t) - sol.u), ylabel=\"Error\")\nplot!(sol.t, zero(stack(sol.u)), ribbon=3stack(std(sol.pu)), color=[1 2], label=\"\")\nsavefig(\"./figures/ex_pi_ours.svg\"); nothing # hide","category":"page"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"(Image: Our Errors)","category":"page"},{"location":"probints_comparison/","page":"Comparison to ProbInts","title":"Comparison to ProbInts","text":"Verdict: The provided credible bands are more calibrated!","category":"page"},{"location":"manual/#Solvers-and-Options","page":"Solvers and Options","title":"Solvers and Options","text":"","category":"section"},{"location":"manual/","page":"Solvers and Options","title":"Solvers and Options","text":"EKF0\nEKF1","category":"page"},{"location":"manual/#ODEFilters.EKF0","page":"Solvers and Options","title":"ODEFilters.EKF0","text":"EKF0(; prior=:ibm, order=1, diffusionmodel=:dynamic, smooth=true)\n\nGaussian ODE filtering with zeroth order extended Kalman filter.\n\nCurrently, only the integrated Brownian motion prior :ibm is supported. For the diffusionmodel, chose one of [:dynamic, :dynamicMV, :fixed, :fixedMV, :fixedMAP].\n\nSee also: EKF1\n\nReferences:\n\nM. Schober, S. Särkkä, and P. Hennig: A Probabilistic Model for the Numerical Solution of Initial Value Problems\nF. Tronarp, H. Kersting, S. Särkkä, and P. Hennig: Probabilistic Solutions To Ordinary Differential Equations As Non-Linear Bayesian Filtering: A New Perspective\n\n\n\n\n\n","category":"type"},{"location":"manual/#ODEFilters.EKF1","page":"Solvers and Options","title":"ODEFilters.EKF1","text":"EKF1(; prior=:ibm, order=1, diffusionmodel=:dynamic, smooth=true)\n\nGaussian ODE filtering with first order extended Kalman filter\n\nCurrently, only the integrated Brownian motion prior :ibm is supported. For the diffusionmodel, chose one of [:dynamic, :dynamicMV, :fixed, :fixedMV, :fixedMAP].\n\nSee also: EKF0\n\nReferences:\n\nF. Tronarp, H. Kersting, S. Särkkä, and P. Hennig: Probabilistic Solutions To Ordinary Differential Equations As Non-Linear Bayesian Filtering: A New Perspective\n\n\n\n\n\n","category":"type"},{"location":"#ODEFilters.jl","page":"Home","title":"ODEFilters.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Probabilistic numerical methods for ordinary differential equations.","category":"page"},{"location":"","page":"Home","title":"Home","text":"ODEFilters.jl is a library for probabilistic numerical methods for solving ordinary differential equations. It provides drop-in replacements for classic ODE solvers from DifferentialEquations.jl by extending OrdinaryDiffEq.jl.","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The package can be installed directly from github:","category":"page"},{"location":"","page":"Home","title":"Home","text":"] add https://github.com/nathanaelbosch/ODEFilters.jl","category":"page"},{"location":"#Getting-Started","page":"Home","title":"Getting Started","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"If you are unfamiliar with DifferentialEquations.jl, check out the official tutorial on how to solve ordinary differential equations.","category":"page"},{"location":"#Step-1:-Defining-a-problem","page":"Home","title":"Step 1: Defining a problem","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"First, we set up an ODEProblem to solve the Fitzhugh-Nagumo model.","category":"page"},{"location":"","page":"Home","title":"Home","text":"using ODEFilters\n\nfunction fitz(u, p, t)\n    a, b, c = p\n    return [c*(u[1] - u[1]^3/3 + u[2])\n            -(1/c)*(u[1] -  a - b*u[2])]\nend\n\nu0 = [-1.0; 1.0]\ntspan = (0., 20.)\np = (0.2,0.2,3.0)\nprob = ODEProblem(fitz, u0, tspan, p)\nnothing # hide","category":"page"},{"location":"#Step-2:-Solving-a-problem","page":"Home","title":"Step 2: Solving a problem","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Currently, ODEFilters.jl implements two probabilistic numerical methods: EKF0 and EKF1. In this example we solve the ODE with the default EKF0, for high tolerance levels.","category":"page"},{"location":"","page":"Home","title":"Home","text":"sol = solve(prob, EKF0(), abstol=1e-1, reltol=1e-2)\nnothing # hide","category":"page"},{"location":"#Step-3:-Analyzing-the-solution","page":"Home","title":"Step 3: Analyzing the solution","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Just as in DifferentialEquations.jl, the result of solve is a solution object, and we can access the (mean) values and timesteps as usual","category":"page"},{"location":"","page":"Home","title":"Home","text":"sol[end]\nsol.u[5]\nsol.t[8]","category":"page"},{"location":"","page":"Home","title":"Home","text":"However, the solver returns a probabilistic solution, here a Gaussian distribution over solution values. These can be accessed similarly, with","category":"page"},{"location":"","page":"Home","title":"Home","text":"sol.pu[end]\nsol.pu[5]","category":"page"},{"location":"","page":"Home","title":"Home","text":"By default, the posterior distribution can be evaluated for arbitrary points in time t by treating sol as a function:","category":"page"},{"location":"","page":"Home","title":"Home","text":"sol(0.45)","category":"page"},{"location":"#Plotting-Solutions","page":"Home","title":"Plotting Solutions","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Finally, we can conveniently visualize the result through Plots.jl:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Plots\nplot(sol)\nsavefig(\"./figures/fitzhugh_nagumo.svg\"); nothing # hide","category":"page"},{"location":"","page":"Home","title":"Home","text":"(Image: Fitzhugh-Nagumo Solution)","category":"page"},{"location":"#References","page":"Home","title":"References","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Gaussian ODE Filters:","category":"page"},{"location":"","page":"Home","title":"Home","text":"M. Schober, S. Särkkä, and P. Hennig: A Probabilistic Model for the Numerical Solution of Initial Value Problems\nH. Kersting, T. J. Sullivan, and P. Hennig: Convergence Rates of Gaussian Ode Filters\nF. Tronarp, H. Kersting, S. Särkkä, and P. Hennig: Probabilistic Solutions To Ordinary Differential Equations As Non-Linear Bayesian Filtering: A New Perspective","category":"page"},{"location":"","page":"Home","title":"Home","text":"Probabilistic Numerics:","category":"page"},{"location":"","page":"Home","title":"Home","text":"http://probabilistic-numerics.org/\nP. Hennig, M. A. Osborne, and M. Girolami: Probabilistic numerics and uncertainty in computations\nC. J. Oates and T. J. Sullivan: A modern retrospective on probabilistic numerics","category":"page"}]
}
